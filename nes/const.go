package nes

import "image/color"

type Instruction struct{
	mnemonic string
	addrMode AddrMode
	cycle    uint64
}

var instructions = map[byte]Instruction{
	0x00: {"BRK", Implied, 7},
	0x01: {"ORA", IndirectX, 6},
	0x02: {"KIL", Accumulator, 2},
	0x03: {"SLO", IndirectY, 8},
	0x04: {"NOP", Zeropage, 3},
	0x05: {"ORA", Zeropage, 3},
	0x06: {"ASL", Zeropage, 5},
	0x07: {"SLO", Zeropage, 5},
	0x08: {"PHP", Implied, 3},
	0x09: {"ORA", Immediate, 2},
	0x0A: {"ASL", Accumulator, 2},
	0x0B: {"ANC", Immediate, 2},
	0x0C: {"NOP", Absolute, 4},
	0x0D: {"ORA", Absolute, 4},
	0x0E: {"ASL", Absolute, 6},
	0x0F: {"SLO", Absolute, 6},
	0x10: {"BPL", Relative, 2},
	0x11: {"ORA", IndirectY, 5},
	0x12: {"KIL", Accumulator, 2},
	0x13: {"SLO", IndirectY, 8},
	0x14: {"NOP", ZeropageX, 4},
	0x15: {"ORA", ZeropageX, 4},
	0x16: {"ASL", ZeropageX, 6},
	0x17: {"SLO", ZeropageX, 6},
	0x18: {"CLC", Implied, 2},
	0x19: {"ORA", AbsoluteY, 4},
	0x1A: {"NOP", Accumulator, 2},
	0x1B: {"SLO", AbsoluteY, 7},
	0x1C: {"NOP", AbsoluteX, 4},
	0x1D: {"ORA", AbsoluteX, 4},
	0x1E: {"ASL", AbsoluteX, 7},
	0x1F: {"SLO", AbsoluteX, 7},
	0x20: {"JSR", Absolute, 6},
	0x21: {"AND", IndirectX, 6},
	0x23: {"RLA", IndirectX, 8},
	0x24: {"BIT", Zeropage, 3},
	0x25: {"AND", Zeropage, 3},
	0x26: {"ROL", Zeropage, 5},
	0x27: {"RLA", Zeropage, 5},
	0x28: {"PLP", Implied, 4},
	0x29: {"AND", Immediate, 2},
	0x2A: {"ROL", Accumulator, 2},
	0x2C: {"BIT", Absolute, 4},
	0x2D: {"AND", Absolute, 2},
	0x2E: {"ROL", Absolute, 6},
	0x2F: {"RLA", Absolute, 6},
	0x30: {"BMI", Relative, 2},
	0x31: {"AND", IndirectY, 5},
	0x33: {"RLA", IndirectY, 8},
	0x34: {"NOP", ZeropageX, 4},
	0x35: {"AND", ZeropageX, 4},
	0x36: {"ROL", ZeropageX, 6},
	0x37: {"RLA", ZeropageX, 6},
	0x38: {"SEC", Implied, 2},
	0x39: {"AND", AbsoluteY, 4},
	0x3A: {"NOP", Accumulator, 2},
	0x3B: {"RLA", AbsoluteY, 7},
	0x3C: {"NOP", AbsoluteX, 4},
	0x3D: {"AND", AbsoluteX, 4},
	0x3E: {"ROL", AbsoluteX, 7},
	0x3F: {"RLA", AbsoluteX, 7},
	0x40: {"RTI", Implied, 6},
	0x41: {"EOR", IndirectX, 6},
	0x43: {"SRE", IndirectX, 8},
	0x44: {"NOP", Zeropage, 3},
	0x45: {"EOR", Zeropage, 3},
	0x46: {"LSR", Zeropage, 5},
	0x47: {"SRE", Zeropage, 5},
	0x48: {"PHA", Implied, 3},
	0x49: {"EOR", Immediate, 2},
	0x4A: {"LSR", Accumulator, 2},
	0x4C: {"JMP", Absolute, 3},
	0x4D: {"EOR", Absolute, 4},
	0x4E: {"LSR", Absolute, 6},
	0x4F: {"SRE", Absolute, 6},
	0x50: {"BVC", Relative, 2},
	0x51: {"EOR", IndirectY, 5},
	0x53: {"SRE", IndirectY, 8},
	0x54: {"NOP", ZeropageX, 4},
	0x55: {"EOR", ZeropageX, 4},
	0x56: {"LSR", ZeropageX, 6},
	0x57: {"SRE", ZeropageX, 6},
	0x58: {"CLI", Implied, 2},
	0x59: {"EOR", AbsoluteY, 4},
	0x5A: {"NOP", Accumulator, 2},
	0x5B: {"SRE", AbsoluteY, 7},
	0x5C: {"NOP", AbsoluteX, 4},
	0x5D: {"EOR", AbsoluteX, 4},
	0x5E: {"LSR", AbsoluteX, 7},
	0x5F: {"SRE", AbsoluteX, 7},
	0x60: {"RTS", Implied, 6},
	0x61: {"ADC", IndirectX, 6},
	0x63: {"RRA", IndirectX, 8},
	0x64: {"NOP", Zeropage, 3},
	0x65: {"ADC", Zeropage, 3},
	0x66: {"ROR", Zeropage, 5},
	0x67: {"RRA", Zeropage, 5},
	0x68: {"PLA", Implied, 4},
	0x69: {"ADC", Immediate, 2},
	0x6A: {"ROR", Accumulator, 2},
	0x6C: {"JMP", Indirect, 5},
	0x6D: {"ADC", Absolute, 4},
	0x6E: {"ROR", Absolute, 6},
	0x6F: {"RRA", Absolute, 6},
	0x70: {"BVS", Relative, 2},
	0x71: {"ADC", IndirectY, 5},
	0x73: {"RRA", IndirectY, 8},
	0x74: {"NOP", ZeropageX, 4},
	0x75: {"ADC", ZeropageX, 4},
	0x76: {"ROR", ZeropageX, 6},
	0x77: {"RRA", ZeropageX, 6},
	0x78: {"SEI", Implied, 2},
	0x79: {"ADC", AbsoluteY, 4},
	0x7A: {"NOP", Accumulator, 2},
	0x7B: {"RRA", AbsoluteY, 7},
	0x7C: {"NOP", AbsoluteX, 4},
	0x7D: {"ADC", AbsoluteX, 4},
	0x7E: {"ROR", AbsoluteX, 7},
	0x7F: {"RRA", AbsoluteX, 7},
	0x80: {"NOP", Immediate, 2},
	0x81: {"STA", IndirectX, 6},
	0x82: {"NOP", Immediate, 2},
	0x83: {"SAX", IndirectX, 6},
	0x84: {"STY", Zeropage, 3},
	0x85: {"STA", Zeropage, 3},
	0x86: {"STX", Zeropage, 3},
	0x87: {"SAX", Zeropage, 3},
	0x88: {"DEY", Implied, 2},
	0x89: {"NOP", Implied, 2},
	0x8A: {"TXA", Implied, 2},
	0x8C: {"STY", Absolute, 4},
	0x8D: {"STA", Absolute, 4},
	0x8E: {"STX", Absolute, 4},
	0x8F: {"SAX", Absolute, 4},
	0x90: {"BCC", Relative, 2},
	0x91: {"STA", IndirectY, 6},
	0x94: {"STY", ZeropageX, 4},
	0x95: {"STA", ZeropageX, 4},
	0x96: {"STX", ZeropageY, 4},
	0x97: {"SAX", ZeropageY, 4},
	0x98: {"TYA", Implied, 2},
	0x99: {"STA", AbsoluteY, 5},
	0x9A: {"TXS", Implied, 2},
	0x9C: {"SHY", AbsoluteX, 5},
	0x9D: {"STA", AbsoluteX, 5},
	0xA0: {"LDY", Immediate, 2},
	0xA1: {"LDA", IndirectX, 6},
	0xA2: {"LDX", Immediate, 2},
	0xA3: {"LAX", IndirectX, 6},
	0xA4: {"LDY", Zeropage, 3},
	0xA5: {"LDA", Zeropage, 3},
	0xA6: {"LDX", Zeropage, 3},
	0xA7: {"LAX", Zeropage, 3},
	0xA8: {"TAY", Implied, 2},
	0xA9: {"LDA", Immediate, 2},
	0xAA: {"TAX", Implied, 2},
	0xAC: {"LDY", Absolute, 4},
	0xAD: {"LDA", Absolute, 4},
	0xAE: {"LDX", Absolute, 4},
	0xAF: {"LAX", Absolute, 4},
	0xB0: {"BCS", Relative, 2},
	0xB1: {"LDA", IndirectY, 5},
	0xB2: {"KIL", Accumulator, 2},
	0xB3: {"LAX", IndirectY, 5},
	0xB4: {"LDY", ZeropageX, 4},
	0xB5: {"LDA", ZeropageX, 4},
	0xB6: {"LDX", ZeropageY, 4},
	0xB7: {"LAX", ZeropageY, 4},
	0xB8: {"CLV", Implied, 2},
	0xB9: {"LDA", AbsoluteY, 4},
	0xBA: {"TSX", Implied, 2},
	0xBB: {"LAS", AbsoluteY, 4},
	0xBC: {"LDY", AbsoluteX, 4},
	0xBD: {"LDA", AbsoluteX, 4},
	0xBE: {"LDX", AbsoluteY, 4},
	0xBF: {"LAX", AbsoluteY, 4},
	0xC0: {"CPY", Immediate, 2},
	0xC1: {"CMP", IndirectX, 6},
	0xC2: {"NOP", Immediate, 2},
	0xC3: {"DCP", IndirectX, 8},
	0xC4: {"CPY", Zeropage, 3},
	0xC5: {"CMP", Zeropage, 3},
	0xC6: {"DEC", Zeropage, 5},
	0xC7: {"DCP", Zeropage, 5},
	0xC8: {"INY", Implied, 2},
	0xC9: {"CMP", Immediate, 2},
	0xCA: {"DEX", Implied, 2},
	0xCC: {"CPY", Absolute, 4},
	0xCD: {"CMP", Absolute, 4},
	0xCE: {"DEC", Absolute, 6},
	0xCF: {"DCP", Absolute, 6},
	0xD0: {"BNE", Relative, 2},
	0xD1: {"CMP", IndirectY, 5},
	0xD3: {"DCP", IndirectY, 8},
	0xD4: {"NOP", ZeropageX, 4},
	0xD5: {"CMP", ZeropageX, 4},
	0xD6: {"DEC", ZeropageX, 6},
	0xD7: {"DCP", ZeropageX, 6},
	0xD8: {"CLD", Implied, 2},
	0xD9: {"CMP", AbsoluteY, 4},
	0xDA: {"NOP", Accumulator, 2},
	0xDB: {"DCP", AbsoluteY, 7},
	0xDC: {"NOP", AbsoluteX, 4},
	0xDD: {"CMP", AbsoluteX, 4},
	0xDE: {"DEC", AbsoluteX, 7},
	0xDF: {"DCP", AbsoluteX, 7},
	0xE0: {"CPX", Immediate, 2},
	0xE1: {"SBC", IndirectX, 6},
	0xE3: {"ISC", IndirectX, 8},
	0xE4: {"CPX", Zeropage, 3},
	0xE5: {"SBC", Zeropage, 3},
	0xE6: {"INC", Zeropage, 5},
	0xE7: {"ISC", Zeropage, 5},
	0xE8: {"INX", Implied, 2},
	0xE9: {"SBC", Immediate, 2},
	0xEA: {"NOP", Accumulator, 2},
	0xEB: {"SBC", Immediate, 2},
	0xEC: {"CPX", Absolute, 4},
	0xED: {"SBC", Absolute, 4},
	0xEE: {"INC", Absolute, 6},
	0xEF: {"ISC", Absolute, 6},
	0xF0: {"BEQ", Relative, 2},
	0xF1: {"SBC", IndirectY, 5},
	0xF3: {"ISC", IndirectY, 8},
	0xF4: {"NOP", ZeropageX, 4},
	0xF5: {"SBC", ZeropageX, 4},
	0xF6: {"INC", ZeropageX, 6},
	0xF7: {"ISC", ZeropageX, 6},
	0xF8: {"SED", Implied, 2},
	0xF9: {"SBC", AbsoluteY, 4},
	0xFA: {"NOP", Accumulator, 2},
	0xFB: {"ISC", AbsoluteY, 7},
	0xFC: {"NOP", AbsoluteX, 4},
	0xFD: {"SBC", AbsoluteX, 4},
	0xFE: {"INC", AbsoluteX, 7},
	0xFF: {"ISC", AbsoluteX, 7},
}

var systemPalette [64]color.RGBA

func init() {
	colors := []uint32{
		0x666666, 0x002A88, 0x1412A7, 0x3B00A4, 0x5C007E, 0x6E0040, 0x6C0600, 0x561D00,
		0x333500, 0x0B4800, 0x005200, 0x004F08, 0x00404D, 0x000000, 0x000000, 0x000000,
		0xADADAD, 0x155FD9, 0x4240FF, 0x7527FE, 0xA01ACC, 0xB71E7B, 0xB53120, 0x994E00,
		0x6B6D00, 0x388700, 0x0C9300, 0x008F32, 0x007C8D, 0x000000, 0x000000, 0x000000,
		0xFFFEFF, 0x64B0FF, 0x9290FF, 0xC676FF, 0xF36AFF, 0xFE6ECC, 0xFE8170, 0xEA9E22,
		0xBCBE00, 0x88D800, 0x5CE430, 0x45E082, 0x48CDDE, 0x4F4F4F, 0x000000, 0x000000,
		0xFFFEFF, 0xC0DFFF, 0xD3D2FF, 0xE8C8FF, 0xFBC2FF, 0xFEC4EA, 0xFECCC5, 0xF7D8A5,
		0xE4E594, 0xCFEF96, 0xBDF4AB, 0xB3F3CC, 0xB5EBF2, 0xB8B8B8, 0x000000, 0x000000,
	}

	for i, c := range colors {
		r := byte(c >> 16)
		g := byte(c >> 8)
		b := byte(c)
		systemPalette[i] = color.RGBA{R: r, G: g, B: b, A: 0xFF}
	}
}